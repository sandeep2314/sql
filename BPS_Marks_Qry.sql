SELECT  MAX(StudentName) StudentName, SubjectName, SubjectCode , Max(FatherName)FatherName, MAX(MotherName)MotherName, MAX(DOB)DOB, MAX(AdmissionNo)AdmNo , MAX(ClassName) className, MAX(SectionName) SectionName , MAX(SubjectGroupName)SubjectGroupName  , MAX(PerTest1)PerTest1  , MAX(NoteBook1)NoteBook1  , MAX(SEA1)SEA1  , MAX(HalfYearly)HalfYearly  , MAX(PerTest2)PerTest2  , MAX(NoteBook2)NoteBook2  , MAX(SEA2)SEA2  , MAX(Yearly) Yearly  , MAX(PT3)PT3  , MAX(PT4)PT4  , MAX(PT11)PT11  , MAX(PT12)PT12  , MAX(PT13)PT13  , MAX(PT14)PT14  , MAX(PT15)PT15  , MAX(PT16)PT16  , MAX(PT17)PT17  , MAX(PT18)PT18  , MAX(PT19)PT19  , MAX(PT20)PT20  , MAX(PT21)PT21  , MAX(PT22)PT22  , MAX(PT23)PT23  , MAX(PT24)PT24  , MAX(PT25)PT25  , MAX(PT26)PT26  , MAX(PT27)PT27  , MAX(PT28)PT28  , MAX(PT29)PT29  , MAX(PT30)PT30  , MAX(PT31)PT31  , MAX(PT32)PT32  , MAX(PT11_MM)PT11_MM  , MAX(PT12_MM)PT12_MM  , MAX(PT13_MM)PT13_MM  , MAX(PT14_MM)PT14_MM  , MAX(PT15_MM)PT15_MM  , MAX(PT16_MM)PT16_MM  , MAX(PT17_MM)PT17_MM  , MAX(PT18_MM)PT18_MM  , MAX(PT19_MM)PT19_MM  , MAX(PT20_MM)PT20_MM  , MAX(PT21_MM)PT21_MM  , MAX(PT22_MM)PT22_MM  , MAX(PT23_MM)PT23_MM  , MAX(PT24_MM)PT24_MM  , MAX(PT25_MM)PT25_MM  , MAX(PT26_MM)PT26_MM  , MAX(PT27_MM)PT27_MM  , MAX(PT28_MM)PT28_MM  , MAX(PT29_MM)PT29_MM  , MAX(PT30_MM)PT30_MM  , MAX(PT31_MM)PT31_MM  , MAX(PT32_MM)PT32_MM   , MAX(PerTest1_Code) PerTest1_Code  , MAX(NoteBook1_Code)NoteBook1_Code   , MAX(SEA1_Code)SEA1_Code   , MAX(HalfYearly_Code)HalfYearly_Code   , MAX(PerTest2_Code)PerTest2_Code   , MAX(NoteBook2_Code)NoteBook2_Code   , MAX(SEA2_Code)SEA2_Code   , MAX(Yearly_Code) Yearly_Code    , MAX(PerTest1_MM) PerTest1_MM  , MAX(NoteBook1_MM)NoteBook1_MM   , MAX(SEA1_MM)SEA1_MM   , MAX(HalfYearly_MM)HalfYearly_MM   , MAX(PerTest2_MM)PerTest2_MM   , MAX(NoteBook2_MM)NoteBook2_MM   , MAX(SEA2_MM)SEA2_MM   , MAX(Yearly_MM) Yearly_MM   FROM  (  SELECT  StudentName, FatherName, MotherName, DOB, AdmissionNo , SubjectGroupName , ClassName, SectionName, SubjectName,  SubjectCode, SubjectOrder ,  (CASE WHEN (ExamName = 'PT1' )  THEN IsNull(MAX(MarksObtained), '0') END) PerTest1  ,(CASE WHEN (ExamName = 'NB1' )  THEN IsNull(MAX(MarksObtained), '0') END) NoteBook1  ,(CASE WHEN (ExamName = 'SEA1' )  THEN IsNull(MAX(MarksObtained), '0') END) SEA1  ,(CASE WHEN (ExamName = 'Half Yearly' )   THEN IsNull(MAX(MarksObtained), '0') END) HalfYearly  ,(CASE WHEN (ExamName = 'PT2' )  THEN IsNull(MAX(MarksObtained), '0') END) PerTest2  ,(CASE WHEN (ExamName = 'NB2' )  THEN IsNull(MAX(MarksObtained), '0') END) NoteBook2  ,(CASE WHEN (ExamName = 'SEA2' )  THEN IsNull(MAX(MarksObtained), '0') END) SEA2  ,(CASE WHEN (ExamName = 'Yearly' )  THEN IsNull(MAX(MarksObtained), '0') END) Yearly  ,(CASE WHEN (ExamName = 'PT3' )  THEN IsNull(MAX(MarksObtained), '0') END) PT3  ,(CASE WHEN (ExamName = 'PT4' )  THEN IsNull(MAX(MarksObtained), '0') END) PT4  ,(CASE WHEN (ExamName = 'PT11' )  THEN IsNull(MAX(MarksObtained), '0') END) PT11  ,(CASE WHEN (ExamName = 'PT12' )  THEN IsNull(MAX(MarksObtained), '0') END) PT12  ,(CASE WHEN (ExamName = 'PT13' )  THEN IsNull(MAX(MarksObtained), '0') END) PT13  ,(CASE WHEN (ExamName = 'PT14' )  THEN IsNull(MAX(MarksObtained), '0') END) PT14  ,(CASE WHEN (ExamName = 'PT15' )  THEN IsNull(MAX(MarksObtained), '0') END) PT15  ,(CASE WHEN (ExamName = 'PT16' )  THEN IsNull(MAX(MarksObtained), '0') END) PT16  ,(CASE WHEN (ExamName = 'PT17' )  THEN IsNull(MAX(MarksObtained), '0') END) PT17  ,(CASE WHEN (ExamName = 'PT18' )  THEN IsNull(MAX(MarksObtained), '0') END) PT18  ,(CASE WHEN (ExamName = 'PT19' )  THEN IsNull(MAX(MarksObtained), '0') END) PT19  ,(CASE WHEN (ExamName = 'PT20' )  THEN IsNull(MAX(MarksObtained), '0') END) PT20  ,(CASE WHEN (ExamName = 'PT21' )  THEN IsNull(MAX(MarksObtained), '0') END) PT21  ,(CASE WHEN (ExamName = 'PT22' )  THEN IsNull(MAX(MarksObtained), '0') END) PT22  ,(CASE WHEN (ExamName = 'PT23' )  THEN IsNull(MAX(MarksObtained), '0') END) PT23  ,(CASE WHEN (ExamName = 'PT24' )  THEN IsNull(MAX(MarksObtained), '0') END) PT24  ,(CASE WHEN (ExamName = 'PT25' )  THEN IsNull(MAX(MarksObtained), '0') END) PT25  ,(CASE WHEN (ExamName = 'PT26' )  THEN IsNull(MAX(MarksObtained), '0') END) PT26  ,(CASE WHEN (ExamName = 'PT27' )  THEN IsNull(MAX(MarksObtained), '0') END) PT27  ,(CASE WHEN (ExamName = 'PT28' )  THEN IsNull(MAX(MarksObtained), '0') END) PT28  ,(CASE WHEN (ExamName = 'PT29' )  THEN IsNull(MAX(MarksObtained), '0') END) PT29  ,(CASE WHEN (ExamName = 'PT30' )  THEN IsNull(MAX(MarksObtained), '0') END) PT30  ,(CASE WHEN (ExamName = 'PT31' )  THEN IsNull(MAX(MarksObtained), '0') END) PT31  ,(CASE WHEN (ExamName = 'PT32' )  THEN IsNull(MAX(MarksObtained), '0') END) PT32   , (CASE WHEN (ExamName = 'PT11' )         THEN IsNull(MAX(MaxMarks), '0') END) PT11_MM    , (CASE WHEN (ExamName = 'PT12' )         THEN IsNull(MAX(MaxMarks), '0') END) PT12_MM    , (CASE WHEN (ExamName = 'PT13' )         THEN IsNull(MAX(MaxMarks), '0') END) PT13_MM    , (CASE WHEN (ExamName = 'PT14' )         THEN IsNull(MAX(MaxMarks), '0') END) PT14_MM    , (CASE WHEN (ExamName = 'PT15' )         THEN IsNull(MAX(MaxMarks), '0') END) PT15_MM    , (CASE WHEN (ExamName = 'PT16' )         THEN IsNull(MAX(MaxMarks), '0') END) PT16_MM    , (CASE WHEN (ExamName = 'PT17' )         THEN IsNull(MAX(MaxMarks), '0') END) PT17_MM    , (CASE WHEN (ExamName = 'PT18' )         THEN IsNull(MAX(MaxMarks), '0') END) PT18_MM    , (CASE WHEN (ExamName = 'PT19' )         THEN IsNull(MAX(MaxMarks), '0') END) PT19_MM    , (CASE WHEN (ExamName = 'PT20' )         THEN IsNull(MAX(MaxMarks), '0') END) PT20_MM    , (CASE WHEN (ExamName = 'PT21' )         THEN IsNull(MAX(MaxMarks), '0') END) PT21_MM    , (CASE WHEN (ExamName = 'PT22' )         THEN IsNull(MAX(MaxMarks), '0') END) PT22_MM    , (CASE WHEN (ExamName = 'PT23' )         THEN IsNull(MAX(MaxMarks), '0') END) PT23_MM    , (CASE WHEN (ExamName = 'PT24' )         THEN IsNull(MAX(MaxMarks), '0') END) PT24_MM    , (CASE WHEN (ExamName = 'PT25' )         THEN IsNull(MAX(MaxMarks), '0') END) PT25_MM    , (CASE WHEN (ExamName = 'PT26' )         THEN IsNull(MAX(MaxMarks), '0') END) PT26_MM    , (CASE WHEN (ExamName = 'PT27' )         THEN IsNull(MAX(MaxMarks), '0') END) PT27_MM    , (CASE WHEN (ExamName = 'PT28' )         THEN IsNull(MAX(MaxMarks), '0') END) PT28_MM    , (CASE WHEN (ExamName = 'PT29' )         THEN IsNull(MAX(MaxMarks), '0') END) PT29_MM    , (CASE WHEN (ExamName = 'PT30' )         THEN IsNull(MAX(MaxMarks), '0') END) PT30_MM    , (CASE WHEN (ExamName = 'PT31' )         THEN IsNull(MAX(MaxMarks), '0') END) PT31_MM    , (CASE WHEN (ExamName = 'PT32' )         THEN IsNull(MAX(MaxMarks), '0') END) PT32_MM    , (CASE WHEN (ExamName = 'PT1' )         THEN IsNull(MAX(MaxMarks), '0') END) PerTest1_MM   ,(CASE WHEN (ExamName = 'NB1' )    THEN IsNull(MAX(MaxMarks), '0') END) NoteBook1_MM   ,(CASE WHEN (ExamName = 'SEA1' )   THEN IsNull(MAX(MaxMarks), '0') END) SEA1_MM   ,(CASE WHEN (ExamName = 'Half Yearly' )    THEN IsNull(MAX(MaxMarks), '0') END) HalfYearly_MM   ,(CASE WHEN (ExamName = 'PT2' )       THEN IsNull(MAX(MaxMarks), '0') END) PerTest2_MM   ,(CASE WHEN (ExamName = 'NB2' )   THEN IsNull(MAX(MaxMarks), '0') END) NoteBook2_MM   ,(CASE WHEN (ExamName = 'SEA2' )   THEN IsNull(MAX(MaxMarks), '0') END) SEA2_MM   ,(CASE WHEN (ExamName = 'Yearly' )   THEN IsNull(MAX(MaxMarks), '0') END) Yearly_MM  , (CASE WHEN (ExamName = 'PT1' )        THEN IsNull(MAX(ExamCode), '0') END) PerTest1_Code  , (CASE WHEN (ExamName = 'NB1' )    THEN IsNull(MAX(ExamCode), '0') END) NoteBook1_Code   ,(CASE WHEN (ExamName = 'SEA1' )     THEN IsNull(MAX(ExamCode), '0') END) SEA1_Code    ,(CASE WHEN (ExamName = 'Half Yearly' )      THEN IsNull(MAX(ExamCode), '0') END) HalfYearly_Code    ,(CASE WHEN (ExamName = 'PT2' )     THEN IsNull(MAX(ExamCode), '0') END) PerTest2_Code     ,(CASE WHEN (ExamName = 'NB2' )     THEN IsNull(MAX(ExamCode), '0') END) NoteBook2_Code     ,(CASE WHEN (ExamName = 'SEA2' )     THEN IsNull(MAX(ExamCode), '0') END) SEA2_Code     ,(CASE WHEN (ExamName = 'Yearly' )     THEN IsNull(MAX(ExamCode), '0') END) Yearly_Code   FROM(   SELECT   StudentMasterId   , StudentName , FatherName, MotherName, DOB, AdmissionNo, SubjectGroupName , MobileF  , ClassName   , SectionName  , TermName  , SubjectName, SubjectCode  , SubjectOrder  , MaxMarks  , ExamName, ExamCode  ,  IsNull(MAX(MarksObtained), '0') marksObtained   FROM tblExamMarks m   LEFT OUTER JOIN tblStudentMaster st  ON m.studentID = st.StudentMasterID    LEFT OUTER JOIN tblClassMaster c  ON c.ClassMasterId = m.ClassID   LEFT OUTER JOIN tblSectionMaster sm  ON sm.sectionMasterID = m.SectionID   LEFT OUTER JOIN tblExamMaster em  ON em.ExamMasterID = m.ExamID   LEFT OUTER JOIN tblSubjectMaster sub  ON sub.SubjectMasterID = m.SubjectId   LEFT OUTER JOIN tblSubjectGroupMaster sgm  ON sgm.SubjectGroupMasterID = sub.SubjectGroupMasterID   LEFT OUTER JOIN tblTerm tm ON tm.TermId = em.termID  WHERE 1=1 AND st.UserID = 12 AND st.FYear =  2014 AND st.studentMasterId = 48515 AND SubjectGroupName='Scholastic' GROUP By  StudentMasterId   , StudentName   , FatherName, MotherName, DOB, AdmissionNo, SubjectGroupName , MobileF   , ClassName   , SectionName   , SubjectName, SubjectCode , SubjectOrder  , ExamName , ExamCode, MaxMarks , TermName  ) as A  GROUP BY StudentName, ExamName , FatherName, MotherName, DOB, AdmissionNo, SubjectGroupName , ClassName, SectionName  , TermName  , SubjectName , SubjectCode  , subjectOrder   ) as b  GROUP BY StudentName, SubjectName, SubjectCode  , SubjectOrder  ORDER BY SubjectOrder 